Device:  cuda
Loading PI CSV from: d:/zsy/坐垫/2024_AIdriven/BCG2BP-main/data/introduction.csv
  已加载个人信息CSV，共40个用户
Loading HR CSV from: D:\zsy\坐垫\文献梳理及画图\论文\20250905第二次投递submitCode_npj digital medicine提交\sorted\result\pred_hr_1d_subject_level.csv
  已加载心率数据，共40个用户
Loading data from: d:/zsy/坐垫/2024_AIdriven/BCG2BP-main/data/Preprocessed_Database_flat.mat     
  找到主数据字段: preprocessed_Data_struct
  数据类型: <class 'numpy.ndarray'>
  数据形状: (1, 40)
  字段名: ('ID', 'PPG', 'Resp', 'ECG', 'Film0', 'Film1', 'Film2', 'Film3', 'LC_BCG0', 'LC_BCG1', 'LC_BCG2', 'LC_BCG3', 'reBAP', 'IBI', 'SV', 'dp_dt')
  总共 40 个受试者
loading 0: X1001
  用户X1001: 裁剪掉1000个NaN样本，保留298000个有效样本
loading 1: X1002
  用户X1002: 裁剪掉1000个NaN样本，保留469000个有效样本
  ⚠️ 警告: 用户X1002窗口115500血压值超出正常范围 SBP=154.45, DBP=-29.21
  ⚠️ 警告: 用户X1002窗口116000血压值超出正常范围 SBP=154.45, DBP=-793.23
loading 2: X1003
  用户X1003: 裁剪掉1000个NaN样本，保留423000个有效样本
loading 3: X1004
loading 4: X1005
loading 5: X1006
loading 6: X1007
loading 7: X1008
  ⚠️ 警告: 用户X1008窗口94000血压值超出正常范围 SBP=117.96, DBP=32.90
  ⚠️ 警告: 用户X1008窗口94500血压值超出正常范围 SBP=117.88, DBP=-796.32
loading 8: X1009
loading 9: X1010
loading 10: X1011
loading 11: X1012
loading 12: X1013
loading 13: X1014
loading 14: X1019
loading 15: X1020
loading 16: X1021
loading 17: X1022
loading 18: X1023
loading 19: X1024
loading 20: X1025
loading 21: X1026
loading 22: X1027
loading 23: X1028
loading 24: X1029
loading 25: X1030
loading 26: X1031
loading 27: X0132
  ⚠️ 警告: 用户X0132窗口69500血压值超出正常范围 SBP=78.50, DBP=52.45
  ⚠️ 警告: 用户X0132窗口70000血压值超出正常范围 SBP=75.98, DBP=51.83
  ⚠️ 警告: 用户X0132窗口70500血压值超出正常范围 SBP=74.72, DBP=51.83
  ⚠️ 警告: 用户X0132窗口71000血压值超出正常范围 SBP=77.21, DBP=51.83
  ⚠️ 警告: 用户X0132窗口93000血压值超出正常范围 SBP=79.07, DBP=56.58
  ⚠️ 警告: 用户X0132窗口99500血压值超出正常范围 SBP=77.97, DBP=56.22
  ⚠️ 警告: 用户X0132窗口100000血压值超出正常范围 SBP=74.52, DBP=54.27
  ⚠️ 警告: 用户X0132窗口100500血压值超出正常范围 SBP=74.12, DBP=53.92
  ⚠️ 警告: 用户X0132窗口101000血压值超出正常范围 SBP=73.13, DBP=53.92
  ⚠️ 警告: 用户X0132窗口101500血压值超出正常范围 SBP=76.91, DBP=53.92
  ⚠️ 警告: 用户X0132窗口102000血压值超出正常范围 SBP=77.69, DBP=55.04
  ⚠️ 警告: 用户X0132窗口102500血压值超出正常范围 SBP=79.02, DBP=56.01
  ⚠️ 警告: 用户X0132窗口103000血压值超出正常范围 SBP=79.02, DBP=55.52
loading 28: X1033
loading 29: X1034
loading 30: X1035
loading 31: X1037
loading 32: X1038
loading 33: X1039
loading 34: X1040
loading 35: X1042
loading 36: X1043
loading 37: X1044
loading 38: X1046
loading 39: X1047
Feature extracting: d:/zsy/坐垫/2024_AIdriven/BCG2BP-main/data/Preprocessed_Database_flat.mat

============================================================
【基于J峰检测的心率统计】
============================================================
X0132: 真实HR=76.74, 检测HR=77.46, MAE=0.72 bpm (窗口数=194)
X1001: 真实HR=40.30, 检测HR=43.29, MAE=2.99 bpm (窗口数=147)
X1002: 真实HR=75.08, 检测HR=75.73, MAE=0.65 bpm (窗口数=231)
X1003: 真实HR=57.71, 检测HR=59.04, MAE=1.34 bpm (窗口数=210)
X1004: 真实HR=55.58, 检测HR=56.41, MAE=0.83 bpm (窗口数=219)
X1005: 真实HR=79.49, 检测HR=78.65, MAE=0.83 bpm (窗口数=212)
X1006: 真实HR=68.22, 检测HR=69.32, MAE=1.09 bpm (窗口数=222)
X1007: 真实HR=62.47, 检测HR=63.76, MAE=1.29 bpm (窗口数=217)
X1008: 真实HR=56.60, 检测HR=56.93, MAE=0.33 bpm (窗口数=188)
X1009: 真实HR=68.49, 检测HR=69.14, MAE=0.65 bpm (窗口数=226)
X1010: 真实HR=74.24, 检测HR=75.06, MAE=0.81 bpm (窗口数=217)
X1011: 真实HR=55.14, 检测HR=55.91, MAE=0.77 bpm (窗口数=221)
X1012: 真实HR=69.16, 检测HR=68.96, MAE=0.20 bpm (窗口数=233)
X1013: 真实HR=54.65, 检测HR=55.31, MAE=0.66 bpm (窗口数=209)
X1014: 真实HR=72.51, 检测HR=73.71, MAE=1.21 bpm (窗口数=209)
X1019: 真实HR=59.39, 检测HR=60.60, MAE=1.22 bpm (窗口数=202)
X1020: 真实HR=85.52, 检测HR=86.55, MAE=1.04 bpm (窗口数=207)
X1021: 真实HR=56.49, 检测HR=57.83, MAE=1.33 bpm (窗口数=204)
X1022: 真实HR=56.22, 检测HR=57.66, MAE=1.43 bpm (窗口数=201)
X1023: 真实HR=54.41, 检测HR=55.57, MAE=1.16 bpm (窗口数=201)
X1024: 真实HR=56.53, 检测HR=58.17, MAE=1.64 bpm (窗口数=209)
X1025: 真实HR=92.21, 检测HR=92.20, MAE=0.01 bpm (窗口数=209)
X1026: 真实HR=87.13, 检测HR=88.29, MAE=1.15 bpm (窗口数=204)
X1027: 真实HR=55.18, 检测HR=56.73, MAE=1.55 bpm (窗口数=202)
X1028: 真实HR=65.31, 检测HR=66.02, MAE=0.71 bpm (窗口数=210)
X1029: 真实HR=71.46, 检测HR=71.61, MAE=0.15 bpm (窗口数=205)
X1030: 真实HR=69.77, 检测HR=70.99, MAE=1.22 bpm (窗口数=205)
X1031: 真实HR=60.88, 检测HR=61.58, MAE=0.70 bpm (窗口数=201)
X1033: 真实HR=56.71, 检测HR=57.78, MAE=1.08 bpm (窗口数=203)
X1034: 真实HR=79.73, 检测HR=81.22, MAE=1.49 bpm (窗口数=208)
X1035: 真实HR=79.05, 检测HR=79.89, MAE=0.84 bpm (窗口数=200)
X1037: 真实HR=76.70, 检测HR=77.23, MAE=0.54 bpm (窗口数=203)
X1038: 真实HR=87.23, 检测HR=88.36, MAE=1.13 bpm (窗口数=201)
X1039: 真实HR=59.71, 检测HR=60.43, MAE=0.73 bpm (窗口数=203)
X1040: 真实HR=88.76, 检测HR=87.59, MAE=1.17 bpm (窗口数=209)
X1042: 真实HR=76.05, 检测HR=75.56, MAE=0.49 bpm (窗口数=206)
X1043: 真实HR=59.83, 检测HR=61.26, MAE=1.43 bpm (窗口数=203)
X1044: 真实HR=73.27, 检测HR=73.85, MAE=0.58 bpm (窗口数=202)
X1046: 真实HR=63.09, 检测HR=64.07, MAE=0.97 bpm (窗口数=204)
X1047: 真实HR=82.05, 检测HR=81.86, MAE=0.19 bpm (窗口数=199)
============================================================
总体: 平均HR MAE = 0.9583 bpm (40个被试)
说明: 此MAE计算方式与test_filter_effect.py一致（先求窗口平均再计算误差）
============================================================